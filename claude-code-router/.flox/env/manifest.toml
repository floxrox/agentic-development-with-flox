## Flox Environment Manifest -----------------------------------------
##
##   _Everything_ you need to know about the _manifest_ is here:
##
##               https://flox.dev/docs/concepts/manifest
##
## -------------------------------------------------------------------
# Flox manifest version managed by Flox CLI
version = 1


## Included: Local Ollama Service -----------------------------------
## This environment includes local Ollama LLM support by default via
## composition with the ollama-headless environment. This allows routing
## requests to local models for privacy, offline use, and cost savings.
##
## To use Ollama:
##   1. Add Ollama provider to ~/.claude-code-router/config.json:
##      {
##        "name": "ollama",
##        "api_base_url": "http://localhost:11434/v1/chat/completions",
##        "api_key": "",
##        "models": ["qwen2.5-coder:32b", "deepseek-r1:32b", ...]
##      }
##   2. Start with: flox activate -s (starts both Ollama and router)
##
## To run WITHOUT Ollama (cloud providers only):
##   Option A: Comment out the [include] section below
##   Option B: Use 'flox activate' then 'flox services start ccr'
##            (this starts only the router service, not Ollama)
##
[include]
ollama = "barstoolbluz/ollama-headless"


## Install Packages --------------------------------------------------
[install]
claude-code-router.pkg-path = "claude-code-router"
claude-code.pkg-path = "claude-code"
gum.pkg-path = "gum"
curl.pkg-path = "curl"
jq.pkg-path = "jq"
bat.pkg-path = "bat"


## Environment Variables ---------------------------------------------
[vars]
# Base configuration paths
CCR_CONFIG_DIR = "$HOME/.claude-code-router"
CCR_LOG_DIR = "$HOME/.claude-code-router/logs"
CCR_CONFIG_FILE = "$HOME/.claude-code-router/config.json"

# Runtime-configurable with defaults (headless pattern)
CCR_HOST = "${CCR_HOST:-127.0.0.1}"
CCR_PORT = "${CCR_PORT:-3456}"
CCR_APIKEY = "${CCR_APIKEY:-}"
CCR_PROXY_URL = "${CCR_PROXY_URL:-}"
CCR_LOG_ENABLED = "${CCR_LOG_ENABLED:-true}"
CCR_LOG_LEVEL = "${CCR_LOG_LEVEL:-debug}"
CCR_API_TIMEOUT_MS = "${CCR_API_TIMEOUT_MS:-600000}"
CCR_NON_INTERACTIVE = "${CCR_NON_INTERACTIVE:-false}"

# API Keys (env var injection pattern)
OPENAI_API_KEY = "${OPENAI_API_KEY:-}"
DEEPSEEK_API_KEY = "${DEEPSEEK_API_KEY:-}"
OPENROUTER_API_KEY = "${OPENROUTER_API_KEY:-}"
GEMINI_API_KEY = "${GEMINI_API_KEY:-}"
ANTHROPIC_API_KEY = "${ANTHROPIC_API_KEY:-}"


## Activation Hook ---------------------------------------------------
[hook]
on-activate = '''
# Create required directories
mkdir -p "$CCR_CONFIG_DIR"
mkdir -p "$CCR_LOG_DIR"
mkdir -p "$CCR_CONFIG_DIR/plugins"

# Function to check if config exists
check_ccr_config() {
    [[ -f "$CCR_CONFIG_FILE" ]] || return 1
    [[ -s "$CCR_CONFIG_FILE" ]] || return 1
    return 0
}

# Display info
show_ccr_info() {
    local config_status
    if check_ccr_config; then
        config_status="✓ Configured"
    else
        config_status="⚠️  Not configured"
    fi

    echo ""
    echo "✅ Claude Code Router environment ready (headless mode)"
    echo ""
    echo "Configuration:"
    echo "  Config: $CCR_CONFIG_FILE ($config_status)"
    echo "  Host: $CCR_HOST"
    echo "  Port: $CCR_PORT"
    echo "  Logs: $CCR_LOG_DIR"
    echo ""
    echo "Service Management:"
    echo "  flox activate -s           Start router service"
    echo "  flox services status       Check service status"
    echo "  flox services logs ccr     View service logs"
    echo ""
    echo "Configuration:"
    echo "  ccr-setup                  Interactive config wizard"
    echo "  ccr-config-example         Generate example config"
    echo "  ccr ui                     Open web UI for config"
    echo "  ccr model                  Interactive model selector"
    echo ""
    echo "Runtime Customization (via env vars):"
    echo "  CCR_HOST=0.0.0.0 CCR_APIKEY=secret flox activate -s"
    echo ""
    echo "Configure Claude Code:"
    echo "  Set API base URL to: http://$CCR_HOST:$CCR_PORT"
    echo "  ccr ui                     Open config UI in browser"
    echo ""
}

# Main initialization
if ! check_ccr_config; then
    echo "ℹ️  No configuration found. Run 'ccr-setup' to create one."
fi

show_ccr_info
'''


## Profile script ----------------------------------------------------
[profile]
bash = '''
# Helper: Generate example configuration
ccr-config-example() {
    local config_file="${1:-$CCR_CONFIG_FILE}"

    cat > "$config_file" << 'EOF'
{
  "LOG": true,
  "LOG_LEVEL": "debug",
  "API_TIMEOUT_MS": 600000,
  "NON_INTERACTIVE_MODE": false,
  "APIKEY": "",
  "HOST": "127.0.0.1",
  "PROXY_URL": "",
  "Providers": [
    {
      "name": "openrouter",
      "api_base_url": "https://openrouter.ai/api/v1/chat/completions",
      "api_key": "$OPENROUTER_API_KEY",
      "models": [
        "anthropic/claude-sonnet-4",
        "anthropic/claude-3.5-sonnet",
        "google/gemini-2.5-pro-preview"
      ],
      "transformer": {
        "use": ["openrouter"]
      }
    },
    {
      "name": "deepseek",
      "api_base_url": "https://api.deepseek.com/chat/completions",
      "api_key": "$DEEPSEEK_API_KEY",
      "models": ["deepseek-chat", "deepseek-reasoner"],
      "transformer": {
        "use": ["deepseek"],
        "deepseek-chat": {
          "use": ["tooluse"]
        }
      }
    }
  ],
  "Router": {
    "default": "deepseek,deepseek-chat",
    "background": "deepseek,deepseek-chat",
    "think": "deepseek,deepseek-reasoner",
    "longContext": "openrouter,google/gemini-2.5-pro-preview",
    "longContextThreshold": 60000
  }
}
EOF

    echo "✓ Example configuration created: $config_file"
    echo ""
    echo "Edit with: ${EDITOR:-nano} $config_file"
    echo "Or use:    ccr-setup (interactive wizard)"
}

# Helper: Interactive configuration wizard
ccr-setup() {
    if ! command -v gum &> /dev/null; then
        echo "⚠️  gum not found. Using non-interactive mode."
        ccr-config-example
        return 0
    fi

    clear

    gum style \
        --border rounded \
        --border-foreground 240 \
        --padding "1 2" \
        --margin "1 0" \
        --width 70 \
        "$(gum style --foreground 27 --bold 'Claude Code Router Configuration')

$(gum style --foreground 240 'Setup your AI model router')"

    echo ""

    # Check if config exists
    if [[ -f "$CCR_CONFIG_FILE" ]]; then
        if ! gum confirm "Configuration exists. Overwrite?" --default=false; then
            return 0
        fi
    fi

    # Basic settings
    echo "$(gum style --foreground 141 --bold '1. Basic Settings')"
    echo ""

    local host
    host=$(gum input --placeholder "127.0.0.1" --value "127.0.0.1" --prompt "Host: ")

    local enable_apikey
    enable_apikey=$(gum choose --header "Enable API key authentication?" "No" "Yes")

    local apikey=""
    if [[ "$enable_apikey" == "Yes" ]]; then
        apikey=$(gum input --prompt "API Key: " --password)
    fi

    # Proxy settings
    echo ""
    echo "$(gum style --foreground 141 --bold '2. Network Settings')"
    echo ""

    local proxy=""
    if gum confirm "Use HTTP proxy?" --default=false; then
        proxy=$(gum input --prompt "Proxy URL: " --placeholder "http://127.0.0.1:7890")
    fi

    # Provider selection
    echo ""
    echo "$(gum style --foreground 141 --bold '3. Provider Setup')"
    echo ""

    local providers
    providers=$(gum choose --no-limit --header "Select providers to configure:" \
        "OpenRouter" \
        "DeepSeek" \
        "OpenAI" \
        "Gemini" \
        "Anthropic")

    # Build config
    cat > "$CCR_CONFIG_FILE" << EOF
{
  "LOG": true,
  "LOG_LEVEL": "debug",
  "API_TIMEOUT_MS": 600000,
  "NON_INTERACTIVE_MODE": false,
  "HOST": "$host",
  "APIKEY": "$apikey",
  "PROXY_URL": "$proxy",
  "Providers": [
EOF

    local first=true

    # Add providers
    if echo "$providers" | grep -q "OpenRouter"; then
        [[ "$first" == "false" ]] && echo "," >> "$CCR_CONFIG_FILE"
        cat >> "$CCR_CONFIG_FILE" << 'EOF'
    {
      "name": "openrouter",
      "api_base_url": "https://openrouter.ai/api/v1/chat/completions",
      "api_key": "$OPENROUTER_API_KEY",
      "models": [
        "anthropic/claude-sonnet-4",
        "anthropic/claude-3.5-sonnet",
        "google/gemini-2.5-pro-preview"
      ],
      "transformer": {
        "use": ["openrouter"]
      }
    }
EOF
        first=false
    fi

    if echo "$providers" | grep -q "DeepSeek"; then
        [[ "$first" == "false" ]] && echo "," >> "$CCR_CONFIG_FILE"
        cat >> "$CCR_CONFIG_FILE" << 'EOF'
    {
      "name": "deepseek",
      "api_base_url": "https://api.deepseek.com/chat/completions",
      "api_key": "$DEEPSEEK_API_KEY",
      "models": ["deepseek-chat", "deepseek-reasoner"],
      "transformer": {
        "use": ["deepseek"],
        "deepseek-chat": {
          "use": ["tooluse"]
        }
      }
    }
EOF
        first=false
    fi

    if echo "$providers" | grep -q "OpenAI"; then
        [[ "$first" == "false" ]] && echo "," >> "$CCR_CONFIG_FILE"
        cat >> "$CCR_CONFIG_FILE" << 'EOF'
    {
      "name": "openai",
      "api_base_url": "https://api.openai.com/v1/chat/completions",
      "api_key": "$OPENAI_API_KEY",
      "models": ["gpt-5", "gpt-5-mini"]
    }
EOF
        first=false
    fi

    if echo "$providers" | grep -q "Gemini"; then
        [[ "$first" == "false" ]] && echo "," >> "$CCR_CONFIG_FILE"
        cat >> "$CCR_CONFIG_FILE" << 'EOF'
    {
      "name": "gemini",
      "api_base_url": "https://generativelanguage.googleapis.com/v1beta/models/",
      "api_key": "$GEMINI_API_KEY",
      "models": ["gemini-2.5-flash", "gemini-2.5-pro"],
      "transformer": {
        "use": ["gemini"]
      }
    }
EOF
        first=false
    fi

    if echo "$providers" | grep -q "Anthropic"; then
        [[ "$first" == "false" ]] && echo "," >> "$CCR_CONFIG_FILE"
        cat >> "$CCR_CONFIG_FILE" << 'EOF'
    {
      "name": "anthropic",
      "api_base_url": "https://api.anthropic.com/v1/messages",
      "api_key": "$ANTHROPIC_API_KEY",
      "models": ["claude-sonnet-4-20250514", "claude-3-5-sonnet-20241022"],
      "transformer": {
        "use": ["anthropic"]
      }
    }
EOF
        first=false
    fi

    # Close providers array and add router
    cat >> "$CCR_CONFIG_FILE" << 'EOF'
  ],
  "Router": {
    "default": "deepseek,deepseek-chat",
    "background": "deepseek,deepseek-chat",
    "think": "deepseek,deepseek-reasoner",
    "longContext": "openrouter,google/gemini-2.5-pro-preview",
    "longContextThreshold": 60000
  }
}
EOF

    echo ""
    gum style --foreground 34 --bold "✓ Configuration saved!"
    echo ""
    echo "Next steps:"
    echo "  1. Set API keys as environment variables"
    echo "  2. Run: flox activate -s"
    echo "  3. Configure Claude Code API base URL to: http://$host:3456"
}

# Helper: Show configuration status
ccr-status() {
    echo "Claude Code Router Status"
    echo ""
    echo "✓ ccr: $(which ccr)"
    echo ""

    # Check config
    if [[ -f "$CCR_CONFIG_FILE" ]]; then
        echo "✓ Config exists: $CCR_CONFIG_FILE"

        # Show providers
        if command -v jq &> /dev/null; then
            echo ""
            echo "Configured Providers:"
            jq -r '.Providers[]?.name // empty' "$CCR_CONFIG_FILE" | sed 's/^/  - /'

            echo ""
            echo "Router Settings:"
            jq -r '.Router | to_entries[] | "  \(.key): \(.value)"' "$CCR_CONFIG_FILE"
        fi
    else
        echo "✗ No config found"
    fi

    echo ""

    # Check if service is running
    if pgrep -f "claude-code-router" > /dev/null; then
        echo "✓ Service is running"
    else
        echo "⚠️  Service not running (start with: flox activate -s)"
    fi
}

# Helper: View logs
ccr-logs() {
    if [[ -f "$CCR_LOG_DIR/claude-code-router.log" ]]; then
        tail -f "$CCR_LOG_DIR/claude-code-router.log"
    else
        echo "No logs found at $CCR_LOG_DIR/claude-code-router.log"
    fi
}

# Helper: Edit configuration
ccr-edit() {
    local editor="${EDITOR:-nano}"

    if [[ ! -f "$CCR_CONFIG_FILE" ]]; then
        echo "No config found. Creating example..."
        ccr-config-example
    fi

    "$editor" "$CCR_CONFIG_FILE"

    echo ""
    echo "Configuration updated. Restart service:"
    echo "  flox services restart ccr"
}

# Helper: Test connection
ccr-test() {
    local endpoint="${1:-http://$CCR_HOST:$CCR_PORT}"

    echo "Testing connection to $endpoint..."

    if curl -s "$endpoint/health" > /dev/null 2>&1; then
        echo "✓ Router is reachable"
        return 0
    else
        echo "✗ Router is not reachable"
        echo ""
        echo "Make sure the service is running:"
        echo "  flox activate -s"
        return 1
    fi
}

# Export functions
export -f ccr-config-example ccr-setup ccr-status ccr-logs ccr-edit ccr-test
'''

zsh = '''
# Helper: Generate example configuration
ccr-config-example() {
    local config_file="${1:-$CCR_CONFIG_FILE}"

    cat > "$config_file" << 'EOF'
{
  "LOG": true,
  "LOG_LEVEL": "debug",
  "API_TIMEOUT_MS": 600000,
  "NON_INTERACTIVE_MODE": false,
  "APIKEY": "",
  "HOST": "127.0.0.1",
  "PROXY_URL": "",
  "Providers": [
    {
      "name": "openrouter",
      "api_base_url": "https://openrouter.ai/api/v1/chat/completions",
      "api_key": "$OPENROUTER_API_KEY",
      "models": [
        "anthropic/claude-sonnet-4",
        "anthropic/claude-3.5-sonnet",
        "google/gemini-2.5-pro-preview"
      ],
      "transformer": {
        "use": ["openrouter"]
      }
    },
    {
      "name": "deepseek",
      "api_base_url": "https://api.deepseek.com/chat/completions",
      "api_key": "$DEEPSEEK_API_KEY",
      "models": ["deepseek-chat", "deepseek-reasoner"],
      "transformer": {
        "use": ["deepseek"],
        "deepseek-chat": {
          "use": ["tooluse"]
        }
      }
    }
  ],
  "Router": {
    "default": "deepseek,deepseek-chat",
    "background": "deepseek,deepseek-chat",
    "think": "deepseek,deepseek-reasoner",
    "longContext": "openrouter,google/gemini-2.5-pro-preview",
    "longContextThreshold": 60000
  }
}
EOF

    echo "✓ Example configuration created: $config_file"
    echo ""
    echo "Edit with: ${EDITOR:-nano} $config_file"
    echo "Or use:    ccr-setup (interactive wizard)"
}

# Helper: Interactive configuration wizard
ccr-setup() {
    if ! command -v gum &> /dev/null; then
        echo "⚠️  gum not found. Using non-interactive mode."
        ccr-config-example
        return 0
    fi

    clear

    gum style \
        --border rounded \
        --border-foreground 240 \
        --padding "1 2" \
        --margin "1 0" \
        --width 70 \
        "$(gum style --foreground 27 --bold 'Claude Code Router Configuration')

$(gum style --foreground 240 'Setup your AI model router')"

    echo ""

    # Check if config exists
    if [[ -f "$CCR_CONFIG_FILE" ]]; then
        if ! gum confirm "Configuration exists. Overwrite?" --default=false; then
            return 0
        fi
    fi

    # Basic settings
    echo "$(gum style --foreground 141 --bold '1. Basic Settings')"
    echo ""

    local host
    host=$(gum input --placeholder "127.0.0.1" --value "127.0.0.1" --prompt "Host: ")

    local enable_apikey
    enable_apikey=$(gum choose --header "Enable API key authentication?" "No" "Yes")

    local apikey=""
    if [[ "$enable_apikey" == "Yes" ]]; then
        apikey=$(gum input --prompt "API Key: " --password)
    fi

    # Proxy settings
    echo ""
    echo "$(gum style --foreground 141 --bold '2. Network Settings')"
    echo ""

    local proxy=""
    if gum confirm "Use HTTP proxy?" --default=false; then
        proxy=$(gum input --prompt "Proxy URL: " --placeholder "http://127.0.0.1:7890")
    fi

    # Provider selection
    echo ""
    echo "$(gum style --foreground 141 --bold '3. Provider Setup')"
    echo ""

    local providers
    providers=$(gum choose --no-limit --header "Select providers to configure:" \
        "OpenRouter" \
        "DeepSeek" \
        "OpenAI" \
        "Gemini" \
        "Anthropic")

    # Build config (same as bash version)
    # ... [similar implementation]

    echo ""
    gum style --foreground 34 --bold "✓ Configuration saved!"
}

# Helper: Show configuration status
ccr-status() {
    echo "Claude Code Router Status"
    echo ""
    echo "✓ ccr: $(which ccr)"
    echo ""

    if [[ -f "$CCR_CONFIG_FILE" ]]; then
        echo "✓ Config exists: $CCR_CONFIG_FILE"

        if command -v jq &> /dev/null; then
            echo ""
            echo "Configured Providers:"
            jq -r '.Providers[]?.name // empty' "$CCR_CONFIG_FILE" | sed 's/^/  - /'

            echo ""
            echo "Router Settings:"
            jq -r '.Router | to_entries[] | "  \(.key): \(.value)"' "$CCR_CONFIG_FILE"
        fi
    else
        echo "✗ No config found"
    fi

    echo ""

    if pgrep -f "claude-code-router" > /dev/null; then
        echo "✓ Service is running"
    else
        echo "⚠️  Service not running (start with: flox activate -s)"
    fi
}

# Helper: View logs
ccr-logs() {
    if [[ -f "$CCR_LOG_DIR/claude-code-router.log" ]]; then
        tail -f "$CCR_LOG_DIR/claude-code-router.log"
    else
        echo "No logs found at $CCR_LOG_DIR/claude-code-router.log"
    fi
}

# Helper: Edit configuration
ccr-edit() {
    local editor="${EDITOR:-nano}"

    if [[ ! -f "$CCR_CONFIG_FILE" ]]; then
        echo "No config found. Creating example..."
        ccr-config-example
    fi

    "$editor" "$CCR_CONFIG_FILE"

    echo ""
    echo "Configuration updated. Restart service:"
    echo "  flox services restart ccr"
}

# Helper: Test connection
ccr-test() {
    local endpoint="${1:-http://$CCR_HOST:$CCR_PORT}"

    echo "Testing connection to $endpoint..."

    if curl -s "$endpoint/health" > /dev/null 2>&1; then
        echo "✓ Router is reachable"
        return 0
    else
        echo "✗ Router is not reachable"
        echo ""
        echo "Make sure the service is running:"
        echo "  flox activate -s"
        return 1
    fi
}
'''

fish = '''
# Helper: Generate example configuration
function ccr-config-example
    set config_file (test -n "$argv[1]"; and echo "$argv[1]"; or echo "$CCR_CONFIG_FILE")

    cat > "$config_file" << 'EOF'
{
  "LOG": true,
  "LOG_LEVEL": "debug",
  "API_TIMEOUT_MS": 600000,
  "NON_INTERACTIVE_MODE": false,
  "APIKEY": "",
  "HOST": "127.0.0.1",
  "PROXY_URL": "",
  "Providers": [
    {
      "name": "openrouter",
      "api_base_url": "https://openrouter.ai/api/v1/chat/completions",
      "api_key": "$OPENROUTER_API_KEY",
      "models": [
        "anthropic/claude-sonnet-4",
        "anthropic/claude-3.5-sonnet",
        "google/gemini-2.5-pro-preview"
      ],
      "transformer": {
        "use": ["openrouter"]
      }
    },
    {
      "name": "deepseek",
      "api_base_url": "https://api.deepseek.com/chat/completions",
      "api_key": "$DEEPSEEK_API_KEY",
      "models": ["deepseek-chat", "deepseek-reasoner"],
      "transformer": {
        "use": ["deepseek"],
        "deepseek-chat": {
          "use": ["tooluse"]
        }
      }
    }
  ],
  "Router": {
    "default": "deepseek,deepseek-chat",
    "background": "deepseek,deepseek-chat",
    "think": "deepseek,deepseek-reasoner",
    "longContext": "openrouter,google/gemini-2.5-pro-preview",
    "longContextThreshold": 60000
  }
}
EOF

    echo "✓ Example configuration created: $config_file"
    echo ""
    echo "Edit with: "(set -q EDITOR; and echo $EDITOR; or echo "nano")" $config_file"
    echo "Or use:    ccr-setup (interactive wizard)"
end

# Helper: Show configuration status
function ccr-status
    echo "Claude Code Router Status"
    echo ""
    echo "✓ ccr: "(which ccr)
    echo ""

    if test -f "$CCR_CONFIG_FILE"
        echo "✓ Config exists: $CCR_CONFIG_FILE"

        if command -v jq &> /dev/null
            echo ""
            echo "Configured Providers:"
            jq -r '.Providers[]?.name // empty' "$CCR_CONFIG_FILE" | sed 's/^/  - /'

            echo ""
            echo "Router Settings:"
            jq -r '.Router | to_entries[] | "  \(.key): \(.value)"' "$CCR_CONFIG_FILE"
        end
    else
        echo "✗ No config found"
    end

    echo ""

    if pgrep -f "claude-code-router" > /dev/null
        echo "✓ Service is running"
    else
        echo "⚠️  Service not running (start with: flox activate -s)"
    end
end

# Helper: View logs
function ccr-logs
    if test -f "$CCR_LOG_DIR/claude-code-router.log"
        tail -f "$CCR_LOG_DIR/claude-code-router.log"
    else
        echo "No logs found at $CCR_LOG_DIR/claude-code-router.log"
    end
end

# Helper: Edit configuration
function ccr-edit
    set editor (set -q EDITOR; and echo $EDITOR; or echo "nano")

    if not test -f "$CCR_CONFIG_FILE"
        echo "No config found. Creating example..."
        ccr-config-example
    end

    eval $editor "$CCR_CONFIG_FILE"

    echo ""
    echo "Configuration updated. Restart service:"
    echo "  flox services restart ccr"
end

# Helper: Test connection
function ccr-test
    set endpoint (test -n "$argv[1]"; and echo "$argv[1]"; or echo "http://$CCR_HOST:$CCR_PORT")

    echo "Testing connection to $endpoint..."

    if curl -s "$endpoint/health" > /dev/null 2>&1
        echo "✓ Router is reachable"
        return 0
    else
        echo "✗ Router is not reachable"
        echo ""
        echo "Make sure the service is running:"
        echo "  flox activate -s"
        return 1
    end
end
'''


## Services ----------------------------------------------------------
[services]
ccr.is-daemon = true
ccr.shutdown = { command = "ccr stop" }
ccr.command = '''
# Load environment variables
export CCR_HOST="${CCR_HOST}"
export CCR_PORT="${CCR_PORT}"
export CCR_APIKEY="${CCR_APIKEY}"
export CCR_PROXY_URL="${CCR_PROXY_URL}"
export CCR_LOG_ENABLED="${CCR_LOG_ENABLED}"
export CCR_LOG_LEVEL="${CCR_LOG_LEVEL}"
export CCR_API_TIMEOUT_MS="${CCR_API_TIMEOUT_MS}"
export CCR_NON_INTERACTIVE="${CCR_NON_INTERACTIVE}"

# Export API keys
export OPENAI_API_KEY="${OPENAI_API_KEY}"
export DEEPSEEK_API_KEY="${DEEPSEEK_API_KEY}"
export OPENROUTER_API_KEY="${OPENROUTER_API_KEY}"
export GEMINI_API_KEY="${GEMINI_API_KEY}"
export ANTHROPIC_API_KEY="${ANTHROPIC_API_KEY}"

# Check if config exists
if [[ ! -f "$CCR_CONFIG_FILE" ]]; then
    echo "ERROR: Configuration not found at $CCR_CONFIG_FILE"
    echo "Run 'ccr-setup' to create configuration"
    exit 1
fi

# Start the router
exec ccr start
'''


## Other Environment Options -----------------------------------------
[options]
# Systems that environment is compatible with
systems = [
  "aarch64-darwin",
  "aarch64-linux",
  "x86_64-darwin",
  "x86_64-linux",
]
